(function(){function l(a){a&&(a=a.replace(/:[0-9]{1,5}/,""));return a}function s(a,c){h.closeFrame();m();var f=document.getElementById("wirecard-hpp-form");f&&f.parentNode.removeChild(f);c&&(w(),h.appendFrame(),a.embedded=!0,a.merchant_origin=t());f=p({formId:"wirecard-hpp-form",requestData:a,action:"https://api.wirecard.com:443/engine/hpp/",target:c?"wirecard-hpp-frame":"_self"});document.body.appendChild(f);f.submit()}function x(){if(-1===document.body.className.indexOf("wirecard-hpp-noscroll")){var a=
u();a?(n||(n=a.getAttribute("content")),a.setAttribute("content","width\x3ddevice-width, initial-scale\x3d1, minimum-scale\x3d1, maximum-scale\x3d1.2")):(a=document.createElement("meta"),a.setAttribute("name","viewport"),a.setAttribute("content","width\x3ddevice-width, initial-scale\x3d1, minimum-scale\x3d1, maximum-scale\x3d1.2"),document.getElementsByTagName("head")[0].appendChild(a));document.body.className+=" wirecard-hpp-noscroll"}}function q(){var a=u();a&&a.setAttribute("content",n?n:"");document.body.className=
document.body.className.replace(" wirecard-hpp-noscroll","")}function w(){if(!document.getElementById("wirecard-hpp-glass")){var a=document.createElement("div");a.setAttribute("id","wirecard-hpp-glass");document.body.appendChild(a);setTimeout(function(){a.setAttribute("class","wirecard-hpp-smoke-bg");y(a)},500)}}function m(){var a=document.getElementById("wirecard-hpp-glass");a&&a.parentNode.removeChild(a)}function y(a){setTimeout(function(){var c=document.createElement("div");c.setAttribute("id",
"wirecard-hpp-loading");a.appendChild(c)},250)}function r(){setTimeout(function(){var a=document.getElementById("wirecard-hpp-loading");a&&a.parentNode.removeChild(a)},750)}function u(){var a=null,c=document.getElementsByTagName("meta");for(i=0;i<c.length;i++)if("viewport"==c[i].getAttribute("name")){a=c[i];break}return a}function v(a){window.addEventListener?window.addEventListener("message",a,!1):window.attachEvent&&window.attachEvent("onmessage",a)}function t(){return window.location.origin?window.location.origin:
window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}function z(a,c){var f=document.getElementById("wirecard-hpp-alert");f||(f=A("wirecard-hpp-error-template"),document.body.appendChild(f));document.getElementById("wirecard-hpp-alert-title").innerHTML=a;document.getElementById("wirecard-hpp-alert-msg").innerHTML=c;f.style.display="block"}function A(a){var c=document.createElement("div");c.setAttribute("id","wirecard-hpp-alert");var f=document.createElement("div");
f.className=a;c.appendChild(f);var e=document.createElement("div");e.id="wirecard-hpp-alert-title";f.appendChild(e);e=document.createElement("div");e.id="wirecard-hpp-alert-msg";f.appendChild(e);e=document.createElement("button");e.innerHTML="Close";e.id="wirecard-hpp-alert-close-btn";e.className=a;e.onclick=function(){m();q();c.style.display="none"};f.appendChild(e);return c}function B(){var a="Message processing failed due to the unexpected origin.\x3cbr\x3eExpected: "+l("https://api.wirecard.com:443")+" but was: "+
l(event.origin);console.error(a)}function p(a){var c=document.getElementById(a.formId);c&&c.parentNode.removeChild(c);c=document.createElement("form");c.setAttribute("id",a.formId);c.setAttribute("method","POST");c.setAttribute("action",a.action);c.setAttribute("target",a.target);if("object"===typeof a.requestData)for(var f in a.requestData)if(a.requestData.hasOwnProperty(f)){var e=document.createElement("input");e.setAttribute("type","hidden");e.setAttribute("name",f);e.setAttribute("value",a.requestData[f]);
c.appendChild(e)}return c}function C(a){var c="";if("object"===typeof a)for(var f in a)c+=encodeURIComponent(f)+"\x3d"+encodeURIComponent(a[f])+"\x26";return c?c.substring(0,c.length-1):c}window.WirecardPaymentPage={};window.WirecardHPP={};(function(){var a=navigator.userAgent.toLowerCase();return-1!=a.indexOf("msie")?parseInt(a.split("msie")[1]):!1})();var n=null;(function(){var a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("href","https://api.wirecard.com:443/engine/skin/default/embeddedLoader.css");
document.getElementsByTagName("head")[0].appendChild(a)})();WirecardPaymentPage.embeddedPay=function(a){s(a,h.isAllowed())};WirecardPaymentPage.hostedPay=function(a){s(a,!1)};WirecardHPP.pay=function(a){WirecardPaymentPage.embeddedPay(a)};WirecardPaymentPage.seamlessRenderForm=function(a){k.renderForm(a)};WirecardPaymentPage.seamlessSubmitForm=function(a){k.submitForm(a)};WirecardPaymentPage.seamlessPay=function(a){k.pay(a)};WirecardPaymentPage.seamlessChangeLocale=function(a){k.changeLocale(a)};
WirecardPaymentPage.seamlessValidateForm=function(a){k.validate(a)};WirecardPaymentPage.seamlessFormIsValid=function(a){k.isValid(a)};WirecardPaymentPage.confirmOrder=function(a){a=p({formId:"wirecard-confirm-order",requestData:a,action:"https://api.wirecard.com:443/engine/hpp/confirmOrder/",target:"_self"});document.body.appendChild(a);a.submit()};var h=function(){var a=function(a){l(a.origin)==l("https://api.wirecard.com:443")?"wirecardHppCloseIframe"==a.data?(h.closeFrame(),m(),q()):"wirecardHppReady"==
a.data?(x(),r()):a.data&&/^wirecardHppJSfunction:/.test(a.data)&&(q(),h.closeFrame(),r(),setTimeout(m,2E3),eval("("+decodeURI(a.data.replace(/^wirecardHppJSfunction:/,""))+")()")):a.data&&/^wirecardHpp/.test(a.data)&&(B(),/^wirecardHppJSfunction/.test(a.data)&&(r(),h.closeFrame(),z("Error",errorMsg)))};return{isAllowed:function(){return!(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)||500>screen.width||500>screen.height)},appendFrame:function(){v(a);
var c=document.createElement("div");c.id="wirecard-hpp-container";c.innerHTML='\x3ciframe id\x3d"wirecard-hpp-frame" name\x3d"wirecard-hpp-frame" sandbox\x3d"allow-same-origin allow-scripts allow-popups allow-forms allow-top-navigation"  allowTransparency\x3d"true" frameborder\x3d"0"\x3e\x3c/iframe\x3e';document.body.appendChild(c);document.getElementById("wirecard-hpp-frame").focus()},closeFrame:function(){window.removeEventListener?window.removeEventListener("message",a,!1):window.detachEvent&&
window.detachEvent("onmessage",a);var c=document.getElementById("wirecard-hpp-container");c&&c.parentNode.removeChild(c)}}}(),k=function(){var a=function(b){this.requestId=b.requestData.request_id;this.wrappingDivId=b.wrappingDivId;this.successCallback=b.onSuccess;this.errorCallback=b.onError;this.requestTimeoutId=-1;this.state=this.step=0;this.formId="wd-seamless-form-"+b.requestData.request_id;this.frameId="wd-seamless-frame-"+b.requestData.request_id},c=function(){var b=[],g=function(){return b.length};
return{size:g,getByRequestId:function(a){if(a)for(var g=0;g<b.length;g++)if(b[g].requestId==a)return b[g];return null},getByWrappingDivId:function(a){if(a)for(var g=0;g<b.length;g++)if(b[g].wrappingDivId==a)return b[g];return null},getFirst:function(){return 0<g()?b[0]:null},addOrReplace:function(g){for(var c=-1,e=0;e<b.length;e++)if(b[e].wrappingDivId==g.wrappingDivId){c=e;break}-1<c&&b.splice(c,1);g=new a(g);b.push(g);return g},each:function(a){for(var g=0;g<b.length;g++)a(b[g])}}}(),f=function(b,
a){var d=null;1==c.size()?d=c.getFirst():b.wrappingDivId&&(d=c.getByWrappingDivId(b.wrappingDivId));var e=!1;if(d){if(1==d.state){if(b.onValidationResult)b.onValidationResult({form_validation_error:"Unable to process request because there is another request in progress."});return}var f=document.getElementById(d.frameId);f&&f.contentWindow&&f.contentWindow.postMessage&&(d.validationCallback=b.onValidationResult,f.contentWindow.postMessage(JSON.stringify({WDEEMSG:{seamlessRequest:{operation:a}}}),"https://api.wirecard.com:443"),
e=!0)}if(!e&&b.onValidationResult)b.onValidationResult({form_validation_error:"Unable to find seamless form"})},e=function(b){var a;if(b.errorCallback||b.instance&&b.instance.errorCallback)a=b.errorCallback||b.instance.errorCallback;if(a){var c={loader_error:b.loaderError};if(b.requestId||b.instance&&b.instance.requestId)c.request_id=b.requestId||b.instance.requestId;if(b.wrappingDivId||b.instance&&b.instance.wrappingDivId)c.wrappingDivId=b.wrappingDivId||b.instance.wrappingDivId;a(c)}},h=function(b,
a,c){a.requestTimeoutId=setTimeout(function(){a.state=3;e({loaderError:b,instance:a})},1E3*c)},k=function(b){return{transaction_state:"failed",status_code_1:"N/A",status_description_1:b}},m=function(b){if(b&&b.data){var a=null;try{a=JSON.parse(b.data)}catch(d){}a&&l(b.origin)==l("https://api.wirecard.com:443")&&a.WDEEMSG&&a.WDEEMSG.seamlessResponse&&(b=c.getByRequestId(a.WDEEMSG.seamlessResponse.request_id))&&(1==b.state?(clearTimeout(b.requestTimeoutId),"success"==a.WDEEMSG.seamlessResponse.transaction_state?
(b.state=2,1==b.step&&(document.getElementById(b.frameId).style.display="block",document.getElementById(b.frameId).focus()),b.successCallback&&b.successCallback(a.WDEEMSG.seamlessResponse)):(b.state=3,b.errorCallback&&b.errorCallback(a.WDEEMSG.seamlessResponse))):1==b.step&&2==b.state&&(b.submitSuccessCallback||b.submitErrorCallback)&&a.WDEEMSG.seamlessResponse.transaction_state?(b.step=2,"success"==a.WDEEMSG.seamlessResponse.transaction_state?b.submitSuccessCallback&&b.submitSuccessCallback(a.WDEEMSG.seamlessResponse):
(b.state=3,b.submitErrorCallback&&b.submitErrorCallback(a.WDEEMSG.seamlessResponse))):b.validationCallback&&a.WDEEMSG.seamlessResponse.form_validation_result?b.validationCallback(a.WDEEMSG.seamlessResponse):b.customMessageCallback&&a.WDEEMSG.seamlessResponse.custom_message&&b.customMessageCallback(a.WDEEMSG.seamlessResponse.custom_message))}};return{renderForm:function(b){if(b&&b.wrappingDivId&&b.onSuccess&&b.onError&&b.requestData&&b.requestData.request_id){var a=document.getElementById(b.wrappingDivId);
if(a)if(c.getByRequestId(b.requestData.request_id))e({loaderError:"Request ID already in use.",requestId:b.requestData.request_id,wrappingDivId:b.wrappingDivId,errorCallback:b.onError});else{var d=c.getByWrappingDivId(b);d&&1==d.state?e({loaderError:"Unable to process request because there is another request in progress.",requestId:b.requestData.request_id,wrappingDivId:b.wrappingDivId,errorCallback:b.onError}):(0==c.size()&&v(m),d=c.addOrReplace(b),d.step=1,d.state=0,d.submitErrorCallback=b.onSubmitError,
d.submitSuccessCallback=b.onSubmitSuccess,d.customMessageCallback=b.onCustomMessage,a.innerHTML='\x3ciframe id\x3d"'+d.frameId+'" name\x3d"'+d.frameId+'" frameborder\x3d"0" style\x3d"display:none" class\x3d"wirecard-seamless-frame"\x3e\x3c/iframe\x3e',(a=document.getElementById(d.formId))&&a.parentNode.removeChild(a),b.requestData.merchant_origin=t(),a=p({formId:d.formId,requestData:b.requestData,action:"https://api.wirecard.com:443/engine/rest/seamless/renderform",target:d.frameId}),document.body.appendChild(a),
d.state=1,h("Seamless form render has timed out.",d,45),a.submit())}else e({loaderError:"Unable to find seamless form wrapping DIV.",wrappingDivId:b.wrappingDivId,errorCallback:b.onError})}else e({loaderError:"Unable to render seamless form. Missing input data.",errorCallback:b?b.onError:null})},submitForm:function(b){if(b&&b.onSuccess&&b.onError){var a;if(b.wrappingDivId){if(!document.getElementById(b.wrappingDivId)){e({loaderError:"Unable to find seamless form wrapping DIV.",wrappingDivId:b.wrappingDivId,
errorCallback:b.onError});return}a=c.getByWrappingDivId(b.wrappingDivId);if(!a){e({loaderError:"Seamless form must be successfully rendered before submit.",wrappingDivId:b.wrappingDivId,requestId:b.requestId,errorCallback:b.onError});return}}else{if(1<c.size()){e({loaderError:"Unable to identify seamless form. Please specify wrappingDivId",wrappingDivId:b.wrappingDivId,requestId:b.requestId,errorCallback:b.onError});return}if(0==c.size()){e({loaderError:"Seamless form must be successfully rendered before submit.",
wrappingDivId:b.wrappingDivId,requestId:b.requestId,errorCallback:b.onError});return}a=c.getFirst()}if(2<a.step||2==a.step&&3!=a.state)e({loaderError:"Seamless form has already been submitted.",instance:a});else if(0==a.step||1==a.step&&2!=a.state)e({loaderError:"Seamless form must be successfully rendered before submit.",instance:a});else{a.step=2;a.state=1;a.successCallback=b.onSuccess;a.errorCallback=b.onError;var d=document.getElementById(a.frameId);d&&d.contentWindow&&d.contentWindow.postMessage&&
d.contentWindow.postMessage(JSON.stringify({WDEEMSG:{seamlessRequest:{operation:"seamlessSubmitForm",data:b.requestData?b.requestData:{}}}}),"https://api.wirecard.com:443");h("Seamless form submit has timed out.",a,45)}}else e({loaderError:"Unable to submit seamless form. Missing input data.",errorCallback:b?b.onError:null})},pay:function(a){if(a&&a.requestData&&a.onSuccess&&a.onError){var c=new XMLHttpRequest;c.open("POST","https://api.wirecard.com:443/engine/rest/seamless/payments",!0);c.setRequestHeader("Content-Type",
"application/x-www-form-urlencoded");c.setRequestHeader("Accept","application/json");c.onreadystatechange=function(){if(4==c.readyState)if(200==c.status||201==c.status){var d=null;try{d=JSON.parse(c.responseText)}catch(e){d=k("Unable to parse response for payment request: "+a.requestData.request_id)}d&&d.paymentJson&&(d=d.paymentJson);"success"==d.transaction_state?a.onSuccess(d):a.onError(d)}else d=k("Communication error when processing payment with request ID: "+a.requestData.request_id),a.onError(d)};
c.send(C(a.requestData))}else e({loaderError:"Missing input data for seamlessPay operation.",errorCallback:a?a.onError:null})},changeLocale:function(a){a&&2==a.length&&0<c.size()&&c.each(function(c){(c=document.getElementById(c.frameId))&&c.contentWindow&&c.contentWindow.postMessage&&c.contentWindow.postMessage(JSON.stringify({WDEEMSG:{seamlessRequest:{operation:"changeLocale",data:{locale:a}}}}),"https://api.wirecard.com:443")})},validate:function(a){f(a,"validate")},isValid:function(a){f(a,"isValid")}}}()})();